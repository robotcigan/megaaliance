<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Document</title>
    <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
    <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>
</head>

<body>
    <div class="grid grid--container">
        <h1>Maptest 3</h1>
        <div class="my-map">
            <div id="my-map"></div>
        </div>
    </div>
    <style>
    #my-map {
        height: 100%;
    }

    .my-map {
        height: 500px;
        opacity: 1;
        width: 100%;
    }
    </style>
    <script>
      // Карта яндекс
      ymaps.ready(init);

      function init () {
          var myMap = new ymaps.Map('my-map', {
                  center: [55.76, 37.64],
                  zoom: 8
              }, {
                  searchControlProvider: 'yandex#search'
              }),
              objectManager = new ymaps.ObjectManager({
                  // Чтобы метки начали кластеризоваться, выставляем опцию.
                  clusterize: true,
                  // ObjectManager принимает те же опции, что и кластеризатор.
                  gridSize: 32,
                  clusterDisableClickZoom: true
              });

          // Чтобы задать опции одиночным объектам и кластерам,
          // обратимся к дочерним коллекциям ObjectManager.
          objectManager.objects.options.set('preset', 'islands#greenDotIcon');
          objectManager.clusters.options.set('preset', 'islands#greenClusterIcons');
          myMap.geoObjects.add(objectManager);

          $.ajax({
              url: "pharmy3.json"
          }).done(function(data) {
              for (var i = 0; i < data.features.length; i++) {
                var item = data.features[i];
                item.id = i;
                ymaps.geocode(item.properties.Field4).then(function(res) {
                  item.geometry.coordinates = res.geoObjects.get(0).geometry.getCoordinates();
                });
                // data.properties.balloonContentHeader = '<p>balloonContentHeader</p>';
                // data.properties.balloonContentBody = '<p>balloonContentBody</p>';
                // data.properties.balloonContentFooter = '<p>balloonContentFooter</p>';
                // data.properties.clusterCaption = '<strong><s>Еще</s> одна</strong> метка';
                // data.properties.hintContent = '<p>hintContent</p>';
                // console.log(i === data.features.length - 1)
              }
              console.log('data', data)
              objectManager.add(data);
          });

      }
    </script>
</body>

</html>